# 分布式系统设计课程作业

## Chandy Lamport快照算法

在i,j,k三个节点构成的模拟网络环境中基于全联通逻辑拓扑结构，以资源转移为应用背景，仿真实现Chandy和Lamport快照算法。

- 每条通道均有不同的延迟，且任何通道内均允许存在多条消息
- 整个实验所完成的系统由C节点（控制节点）和P节点（对等节点）两个部分构成

### 网络环境

- i,j节点位于A主机
- k,c节点位于B主机
- i/j/k/c节点接收端口分别是：777/888/999/666

### 通道延迟

| IJ | JI | IK | KI | JK | KJ |
| -- | -- | -- | -- | -- | -- |
| 1000 | 1300 | 1600 | 1900 | 2100 | 2400 |

### 协议

#### C节点接收的消息（快照结果）

消息数据类型：`String`\
格式：10元组，用`|`分割，分别代表快照编号和快照结果
```
ID|i|j|k|ij|ji|ik|ki|jk|kj
```

#### P节点接收的消息

消息数据类型：`String`\
格式：由命令码和参数两部分组成，各部分用`|`连接

- 命令码1：从C节点向P节点发送的资源转移消息
    - 参数：转移目标编号，转移资源数
    - 例：若C产生的下一原始事件为i节点向j节点转移20资源，对应的消息为：C节点向i节点发送字符串`1|j|20`
- 命令码2：从C节点向P节点发送的快照消息
    - 参数：快照编号
    - 例：若C产生的下一原始事件为j节点发起编号为201的快照：C节点向j节点发送字符串`2|201`
- 命令码3：从P节点向P节点进行资源转移消息
    - 参数：转移资源数
    - 例：i节点向j节点转移20资源：i节点向j节点发送字符串`3|i|20`
- 命令码4：从P节点向P节点发送快照标记消息
    - 参数：快照编号
    - 例：i节点向j节点发送201快照的快照标记：i节点向j节点发送字符串`4|i|201`
- 命令码5：从C节点向P节点发送的结束消息
    - 参数：无
